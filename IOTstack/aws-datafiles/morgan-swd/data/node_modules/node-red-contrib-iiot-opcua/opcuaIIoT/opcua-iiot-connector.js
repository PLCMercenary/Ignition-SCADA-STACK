"use strict";module.exports=function(s){require("source-map-support").install();var b=require("./core/opcua-iiot-core-connector"),t=require("path"),f=require("underscore");s.nodes.registerType("OPCUA-IIoT-Connector",function(e){s.nodes.createNode(this,e),this.discoveryUrl=e.discoveryUrl||null,this.endpoint=e.endpoint,this.endpointMustExist=e.endpointMustExist||!1,this.keepSessionAlive=e.keepSessionAlive,this.loginEnabled=e.loginEnabled,this.name=e.name,this.showErrors=e.showErrors,this.securityPolicy=e.securityPolicy,this.messageSecurityMode=e.securityMode,this.publicCertificateFile=e.publicCertificateFile,this.privateKeyFile=e.privateKeyFile,this.defaultSecureTokenLifetime=e.defaultSecureTokenLifetime||6e4,this.autoSelectRightEndpoint=e.autoSelectRightEndpoint,this.strategyMaxRetry=e.strategyMaxRetry||200,this.strategyInitialDelay=e.strategyInitialDelay||1e3,this.strategyMaxDelay=e.strategyMaxDelay||3e4,this.strategyRandomisationFactor=e.strategyRandomisationFactor||.2,this.requestedSessionTimeout=e.requestedSessionTimeout||6e4;var i=this;i.setMaxListeners(0),i.client=null,i.sessionConnectRetries=0,i.endpoints=[],i.userIdentity=null,i.opcuaClient=null,i.opcuaSession=null,i.discoveryServer=null,i.serverCertificate=null,i.discoveryServerEndpointUrl=null,i.sessionNotInRenewMode=!0,i.stateMachine=b.createStatelyMachine(),i.stateMachine.init();var n=null,o=b.core.getNodeOPCUAClientPath();i.securedCommunication=i.securityPolicy&&"None"!==i.securityPolicy&&i.messageSecurityMode&&"NONE"!==i.messageSecurityMode,b.detailDebugLog("config: "+i.publicCertificateFile),b.detailDebugLog("config: "+i.privateKeyFile),b.detailDebugLog("securedCommunication: "+i.securedCommunication.toString()),i.securedCommunication?(null!==i.publicCertificateFile&&""!==i.publicCertificateFile||(i.publicCertificateFile=t.join(o,"/certificates/client_selfsigned_cert_1024.pem"),b.detailDebugLog("default key: "+i.publicCertificateFile)),null!==i.privateKeyFile&&""!==i.privateKeyFile||(i.privateKeyFile=t.join(o,"/certificates/PKI/own/private/private_key.pem"),b.detailDebugLog("default key: "+i.privateKeyFile))):(i.publicCertificateFile=null,i.privateKeyFile=null),i.opcuaClientOptions={securityPolicy:i.securityPolicy||"None",securityMode:i.messageSecurityMode||"NONE",defaultSecureTokenLifetime:i.defaultSecureTokenLifetime,keepSessionAlive:i.keepSessionAlive,certificateFile:i.publicCertificateFile,privateKeyFile:i.privateKeyFile,endpoint_must_exist:i.endpointMustExist,requestedSessionTimeout:i.requestedSessionTimeout,connectionStrategy:{maxRetry:i.strategyMaxRetry,initialDelay:i.strategyInitialDelay,maxDelay:i.strategyMaxDelay,randomisationFactor:i.strategyRandomisationFactor}},i.loginEnabled&&(i.credentials?(i.userIdentity={userName:i.credentials.user,password:i.credentials.password},b.internalDebugLog("Connecting With Login Data On "+i.endpoint)):i.error(new Error("Login Enabled But No Credentials"),{payload:""})),i.connectOPCUAEndpoint=function(){b.internalDebugLog("Connecting On "+i.endpoint),b.detailDebugLog("Options "+JSON.stringify(i.opcuaClientOptions)),i.opcuaClient=new b.core.nodeOPCUA.OPCUAClient(i.opcuaClientOptions),i.autoSelectRightEndpoint&&i.autoSelectEndpointFromConnection(),s.settings.verbose&&(b.internalDebugLog("!!!!!!!!!!!!!!!!!!!!!!!!!  CLIENT INFORMATION !!!!!!!!!!!!!!!!!!!!!!!!!".bgWhite.yellow),b.internalDebugLog("Client Information: "+i.opcuaClient.toString())),i.opcuaClient.on("close",function(e){e&&b.internalDebugLog("Connection Error On Close "+e),b.internalDebugLog("!!!!!!!!!!!!!!!!!!!!!!!!  CLIENT CONNECTION CLOSED !!!!!!!!!!!!!!!!!!!".bgWhite.red),b.internalDebugLog("CONNECTION CLOSED: "+i.endpoint),i.emit("server_connection_close"),i.stateMachine.close().lock()}),i.opcuaClient.on("backoff",function(e,n){b.internalDebugLog("!!! CONNECTION FAILED FOR #".bgWhite.yellow,e," retrying ",n/1e3," sec. !!!"),b.internalDebugLog("CONNECTION FAILED: "+i.endpoint)}),i.opcuaClient.on("connection_reestablished",function(){b.internalDebugLog("!!!!!!!!!!!!!!!!!!!!!!!!  CLIENT CONNECTION RE-ESTABLISHED !!!!!!!!!!!!!!!!!!!".bgWhite.orange),b.internalDebugLog("CONNECTION RE-ESTABLISHED: "+i.endpoint),i.stateMachine.unlock().open()}),i.opcuaClient.on("start_reconnection",function(){b.internalDebugLog("!!!!!!!!!!!!!!!!!!!!!!!!  CLIENT STARTING RECONNECTION !!!!!!!!!!!!!!!!!!!".bgWhite.yellow),b.internalDebugLog("CONNECTION STARTING RECONNECTION: "+i.endpoint),i.stateMachine.lock()}),i.opcuaClient.on("timed_out_request",function(){b.internalDebugLog("!!!!!!!!!!!!!!!!!!!!!!!! CLIENT TIMED OUT REQUEST !!!!!!!!!!!!!!!!!!!".bgWhite.blue),b.internalDebugLog("CONNECTION TIMED OUT REQUEST: "+i.endpoint)}),s.settings.verbose&&(i.opcuaClient.on("security_token_renewed",function(){b.internalDebugLog("!!!!!!!!!!!!!!!!!!!!!!!! CLIENT SECURITY TOKEN RENEWED !!!!!!!!!!!!!!!!!!!".bgWhite.violet),b.internalDebugLog("CONNECTION SECURITY TOKEN RENEWE: "+i.endpoint)}),i.opcuaClient.on("timed_out_request",function(){b.internalDebugLog("!!!!!!!!!!!!!!!!!!!!!!!! CLIENT REQUEST TIMEOUT !!!!!!!!!!!!!!!!!!!".bgWhite.red),b.internalDebugLog("CLIENT REQUEST TIMEOUT: "+i.endpoint)})),i.opcuaClient.on("after_reconnection",function(){b.internalDebugLog("!!!!!!!!!!!!!!!!!!!!!!!!      CLIENT RECONNECTED     !!!!!!!!!!!!!!!!!!!".bgWhite.green),b.internalDebugLog("CONNECTION RECONNECTED: "+i.endpoint),i.emit("after_reconnection",i.opcuaClient),i.setSessionToRenewMode(),i.startSession("after_reconnection"),i.stateMachine.unlock().init()}),i.connectToClient()},i.connectToClient=function(){i.opcuaClient.connect(i.endpoint,function(e){e?(b.internalDebugLog("Client Error: "+e),i.showErrors&&i.error(e,{payload:"Client Connect Error"}),i.handleError(e)):(b.internalDebugLog("Client Connected On "+i.endpoint),b.internalDebugLog("Client Options "+JSON.stringify(i.opcuaClientOptions)),i.emit("connected",i.opcuaClient),i.opcuaSession=null,i.stateMachine.init(),i.startSession("on connect"))})},i.renewConnection=function(){i.opcuaClient.disconnect(function(e){e?(b.internalDebugLog("Disconnected With Error "+e+" From "+i.endpoint),i.showErrors&&i.error(e,{payload:"Error On Close Connector For Renew"})):b.internalDebugLog("Disconnected From "+i.endpoint),i.connectToClient()})},i.autoSelectEndpointFromConnection=function(){b.internalDebugLog("Auto Searching For Endpoint On "+i.endpoint);var o=i.opcuaClientOptions.endpoint_must_exist;i.opcuaClientOptions.endpoint_must_exist=!1;var t=new b.core.nodeOPCUA.OPCUAClient(i.opcuaClientOptions);t.connect(i.endpoint).then(function(){b.internalDebugLog("Auto Searching Endpoint Connected To "+i.endpoint),t.getEndpointsRequest(function(e,n){e?(b.internalDebugLog("Auto Switch To Endpoint Error "+e),i.showErrors&&i.error(e,{payload:"Get Endpoints Request Error"})):n.forEach(function(e,n){b.internalDebugLog("Auto Endpoint "+e.endpointUrl.toString()+" "+e.securityPolicyUri.toString());var o=e.securityMode.key||e.securityMode,t=e.securityPolicyUri.includes("SecurityPolicy#")?e.securityPolicyUri.split("#")[1]:e.securityPolicyUri;b.internalDebugLog("node-mode:"+i.messageSecurityMode+" securityMode: "+o),b.internalDebugLog("node-policy:"+i.securityPolicy+" securityPolicy: "+t),o===i.messageSecurityMode&&t===i.securityPolicy&&(i.endpoint=e.endpointUrl,b.internalDebugLog("Auto Switch To Endpoint "+i.endpoint))}),i.opcuaClientOptions.endpoint_must_exist=o,t.disconnect(function(e){e?(b.internalDebugLog("Endpoints Auto Request Error "+e),i.showErrors&&i.error(e,{payload:"Discover Client Disconnect Error"})):b.internalDebugLog("Endpoints Auto Request Done With Endpoint "+i.endpoint)})})}).catch(function(e){b.internalDebugLog("Get Auto Endpoint Request Error "+e.message),i.opcuaClientOptions.endpoint_must_exist=o})},i.startSession=function(n){if(b.internalDebugLog("Request For New Session From "+n),i.sessionNotInRenewMode)b.internalDebugLog("Start New Session");else if(i.opcuaSession&&"terminated"!==i.opcuaSession.sessionId)return void b.internalDebugLog("Working Session On Start Request");"END"!==i.stateMachine.getMachineState()?i.opcuaClient?(i.opcuaSession=null,i.opcuaClient.createSession(i.userIdentity||{}).then(function(e){b.internalDebugLog("Session Created On "+i.endpoint+" For "+n),i.stateMachine.open(),i.opcuaSession=e,s.settings.verbose&&(b.internalDebugLog("!!!!!!!!!!!!!!!!!!!!!    CLIENT SESSION INFORMATION   !!!!!!!!!!!!!!!!!!".bgWhite.yellow),i.logSessionInformation(i.opcuaSession)),i.opcuaSession.on("session_closed",function(e){b.internalDebugLog("Session Closed With StatusCode "+e),s.settings.verbose&&(b.internalDebugLog("!!!!!!!!!!!!!!!!!!!!!    CLIENT SESSION CLOSED   !!!!!!!!!!!!!!!!!!".bgWhite.yellow),i.logSessionInformation(i.opcuaSession)),i.handleSessionClose()}),i.emit("session_started",i.opcuaSession),i.sessionConnectRetries=0}).catch(function(e){b.internalDebugLog("Create Session "+e),i.showErrors&&i.error(e,{payload:"Create Session Error"}),i.opcuaSession=null,i.renewConnection("Renew Session From Catch Session Create")})):(b.internalDebugLog("OPC UA Client Is Not Valid"),i.connectOPCUAEndpoint()):b.internalDebugLog("State Is End While Try To Reconnect")},i.logSessionInformation=function(e){if(!i.opcuaSession)return b.internalDebugLog("Session Not Valid To Log Information"),void(i.showErrors&&i.error(new Error("Session Not Valid To Log Information"),{payload:"No Session Information"}));b.internalDebugLog("Session "+e.name+" Id: "+e.sessionId+" Started On "+i.endpoint),b.detailDebugLog("name :"+e.name),b.detailDebugLog("sessionId :"+e.sessionId),b.detailDebugLog("authenticationToken :"+e.authenticationToken),b.internalDebugLog("timeout :"+e.timeout),e.serverNonce&&b.detailDebugLog((e.serverNonce,e.serverNonce.toString("hex"))),e.serverCertificate?b.detailDebugLog((e.serverCertificate,e.serverCertificate.toString("base64"))):b.detailDebugLog("serverCertificate : None".red),b.detailDebugLog((e.serverSignature,e.serverSignature)),e.lastRequestSentTime&&(b.detailDebugLog("lastRequestSentTime : "+e.lastRequestSentTime),b.internalDebugLog((e.lastRequestSentTime,new Date(e.lastRequestSentTime).toISOString()))),e.lastResponseReceivedTime&&(b.detailDebugLog("lastResponseReceivedTime : "+e.lastResponseReceivedTime),b.internalDebugLog((e.lastResponseReceivedTime,new Date(e.lastResponseReceivedTime).toISOString())))},i.resetBadSession=function(){i.resetSessionRenewMode(),b.internalDebugLog("Reset Bad Session Connect Retries:"+i.sessionConnectRetries),i.sessionConnectRetries+=1,s.settings.verbose&&(b.internalDebugLog("!!!!!!!!!!!!!!!!!!!!!   BAD SESSION CLOSE BY CONNECTOR   !!!!!!!!!!!!!!!!!!".bgWhite.yellow),i.logSessionInformation(i.opcuaSession)),i.renewSession("Renew From BadSession")},i.renewSession=function(e){i.opcuaSession&&"terminated"!==i.opcuaSession.sessionId?i.opcuaClient.closeSession(i.opcuaSession,!1,function(e){e&&(b.internalDebugLog("Client Bad Session Close "+e),i.showErrors&&i.error(e,{payload:"Client Bad Session Close Error"})),n&&(clearTimeout(n),n=null),n=setTimeout(function(){i.startSession("Renew Session After Close")},500)}):(n&&(clearTimeout(n),n=null),n=setTimeout(function(){i.startSession("Renew Session")},500))},i.setSessionToRenewMode=function(){i.stateMachine.unlock().init(),i.sessionNotInRenewMode=!1},i.resetSessionRenewMode=function(){i.stateMachine.close().lock(),i.sessionNotInRenewMode=!0},i.handleError=function(e){b.internalDebugLog("Handle Error On "+i.endpoint+" err:"+e),i.showErrors&&i.error(e,{payload:"Handle Connector Error"})},i.handleSessionClose=function(e){i.stateMachine.close().lock(),e?(b.internalDebugLog("Session Closed With Error "+e),i.showErrors&&i.error(e,{payload:"Session Closed"})):b.internalDebugLog("Session Closed"),i.resetSessionRenewMode(),n&&(clearTimeout(n),n=null),n=setTimeout(function(){i.startSession("Handle Session Close")},500)};try{setTimeout(i.connectOPCUAEndpoint,2e3)}catch(e){b.internalDebugLog("Connect OPC UA Endpoint "+e),i.showErrors&&i.error(e,{payload:"Connect OPC UA Endpoint Error"})}i.on("close",function(n){i.stateMachine.end(),i.opcuaClient?i.opcuaSession?(b.internalDebugLog("Close Node Try To Close Session For "+i.endpoint),i.opcuaClient.closeSession(i.opcuaSession,!0,function(){b.internalDebugLog("Close Node Session Closed For "+i.endpoint),b.internalDebugLog("Close Node Disconnecting Client "+i.endpoint),i.opcuaClient.disconnect(function(e){e?(b.internalDebugLog("Close Node Client Disconnected With Error "+e+" On "+i.endpoint),i.showErrors&&i.error(e,{payload:"Session Close Error On Close Connector"})):b.internalDebugLog("Close Node Client Disconnected From "+i.endpoint),n(),b.internalDebugLog("Close Node Done For Connector On "+i.endpoint)})}).catch(function(e){e&&(b.internalDebugLog("Close Node With Session Close Error "+e+" On "+i.endpoint),i.showErrors&&i.error(e,{payload:"Session Close Crash On Close Connector"})),b.internalDebugLog("Close Node Disconnecting Client On Crashed Session Close On "+i.endpoint),i.opcuaClient.disconnect(function(e){e?(b.internalDebugLog("Close Node With Client Close Error On Crashed Session Close "+e+" On "+i.endpoint),i.showErrors&&i.error(e,{payload:"Client Close Error On Close Connector"})):b.internalDebugLog("Close Node Client Disconnected On Crashed Session Close On "+i.endpoint),n(),b.internalDebugLog("Close Node Done For Connector With Crashed Session Close On "+i.endpoint)})})):(b.internalDebugLog("Close Node Disconnect Connector From "+i.endpoint),i.opcuaClient.disconnect(function(e){e?(b.internalDebugLog("Close Node Disconnected Connector From "+i.endpoint+" with Error "+e),i.showErrors&&i.error(e,{payload:"Client Close Error On Close Connector"})):b.internalDebugLog("Close Node Disconnected Connector From "+i.endpoint),n(),b.internalDebugLog("Close Node Done For Connector On "+i.endpoint)})):(n(),b.internalDebugLog("Close Node Done For Connector Without Client On "+i.endpoint))})},{credentials:{user:{type:"text"},password:{type:"password"}}}),s.httpAdmin.get("/opcuaIIoT/client/discover/:id/:discoveryUrl",s.auth.needsPermission("opcua.discovery"),function(e,t){var i=s.nodes.getNode(e.params.id),r=decodeURIComponent(e.params.discoveryUrl);(b.internalDebugLog("Get Discovery Request "+JSON.stringify(e.params)+" for "+r),i)?r&&!r.includes("opc.tcp://")?t.json([]):(0,b.core.nodeOPCUA.perform_findServersRequest)(r,function(e,n){if(e)b.internalDebugLog("Perform Find Servers Request "+e),i.showErrors&&i.error(e,{payload:""}),t.json([]);else{var o=[];n.forEach(function(e){e.discoveryUrls.forEach(function(e){e.toString()!==r&&o.push(e.toString())})}),t.json(o)}}):(b.internalDebugLog("Get Discovery Request None Node "+JSON.stringify(e.params)),t.json([]))}),s.httpAdmin.get("/opcuaIIoT/client/endpoints/:id/:endpointUrl",s.auth.needsPermission("opcua.endpoints"),function(e,o){var t=s.nodes.getNode(e.params.id),n=decodeURIComponent(e.params.endpointUrl);if(b.internalDebugLog("Get Endpoints Request "+JSON.stringify(e.params)+" for "+n),t)if(n&&!n.includes("opc.tcp://"))o.json([]);else{t.opcuaClientOptions.endpoint_must_exist=!1;var i=new b.core.nodeOPCUA.OPCUAClient(t.opcuaClientOptions);i.connect(n).then(function(){b.internalDebugLog("Get Endpoints Connected For Request"),i.getEndpointsRequest(function(e,n){e?(t.showErrors&&t.error(e,{payload:""}),b.internalDebugLog("Get Endpoints Request Error "+e),o.json([])):(b.internalDebugLog("Sending Endpoints For Request"),o.json(n)),i.disconnect(function(){b.internalDebugLog("Get Endpoints Request Disconnect")}),t.opcuaClientOptions.endpoint_must_exist=r})}).catch(function(e){t.opcuaClientOptions.endpoint_must_exist=r,b.internalDebugLog("Get Endpoints Request Error "+e.message),o.json([])});var r=t.opcuaClientOptions.endpoint_must_exist}else b.internalDebugLog("Get Endpoints Request None Node "+JSON.stringify(e.params)),o.json([])}),s.httpAdmin.get("/opcuaIIoT/plain/DataTypeIds",s.auth.needsPermission("opcuaIIoT.plain.datatypes"),function(e,n){n.json(f.toArray(f.invert(b.core.nodeOPCUA.DataTypeIds)))}),s.httpAdmin.get("/opcuaIIoT/plain/AttributeIds",s.auth.needsPermission("opcuaIIoT.plain.attributeids"),function(e,n){n.json(f.toArray(f.invert(b.core.nodeOPCUA.AttributeIds)))}),s.httpAdmin.get("/opcuaIIoT/plain/StatusCodes",s.auth.needsPermission("opcuaIIoT.plain.statuscodes"),function(e,n){n.json(f.toArray(f.invert(b.core.nodeOPCUA.StatusCodes)))}),s.httpAdmin.get("/opcuaIIoT/plain/ObjectTypeIds",s.auth.needsPermission("opcuaIIoT.plain.objecttypeids"),function(e,n){n.json(b.core.nodeOPCUA.ObjectTypeIds)}),s.httpAdmin.get("/opcuaIIoT/plain/VariableTypeIds",s.auth.needsPermission("opcuaIIoT.plain.variabletypeids"),function(e,n){n.json(b.core.nodeOPCUA.VariableTypeIds)}),s.httpAdmin.get("/opcuaIIoT/plain/ReferenceTypeIds",s.auth.needsPermission("opcuaIIoT.plain.referencetypeids"),function(e,n){n.json(b.core.nodeOPCUA.ReferenceTypeIds)}),s.httpAdmin.get("/opcuaIIoT/xmlsets/public",s.auth.needsPermission("opcuaIIoT.xmlsets"),function(e,n){var o=[];o.push(b.core.nodeOPCUA.di_nodeset_filename),o.push(b.core.nodeOPCUA.adi_nodeset_filename),o.push("public/vendor/opc-foundation/xml/Opc.ISA95.NodeSet2.xml"),o.push("public/vendor/opc-foundation/xml/Opc.Ua.Adi.NodeSet2.xml"),o.push("public/vendor/opc-foundation/xml/Opc.Ua.Di.NodeSet2.xml"),o.push("public/vendor/opc-foundation/xml/Opc.Ua.Gds.NodeSet2.xml"),o.push("public/vendor/harting/10_di.xml"),o.push("public/vendor/harting/20_autoid.xml"),o.push("public/vendor/harting/30_aim.xml"),n.json(o)}),s.httpAdmin.get("/opcuaIIoT/list/DataTypeIds",s.auth.needsPermission("opcuaIIoT.list.datatypeids"),function(e,n){var o=b.core.nodeOPCUA.DataTypeIds,t=f.toArray(f.invert(o)),i=[],r=void 0,s=!0,a=!1,l=void 0;try{for(var c,u=t[Symbol.iterator]();!(s=(c=u.next()).done);s=!0)r=c.value,i.push({nodeId:"i="+o[r],label:r})}catch(e){a=!0,l=e}finally{try{!s&&u.return&&u.return()}finally{if(a)throw l}}n.json(i)}),s.httpAdmin.get("/opcuaIIoT/list/EvenTypeIds",s.auth.needsPermission("opcuaIIoT.list.eventtypeids"),function(e,n){var o=b.core.nodeOPCUA.ObjectTypeIds,t=f.invert(o),i=f.filter(t,function(e){return-1<e.indexOf("Event")}),r=void 0,s=[],a=!0,l=!1,c=void 0;try{for(var u,d=i[Symbol.iterator]();!(a=(u=d.next()).done);a=!0)r=u.value,s.push({nodeId:"i="+o[r],label:r})}catch(e){l=!0,c=e}finally{try{!a&&d.return&&d.return()}finally{if(l)throw c}}n.json(s)}),s.httpAdmin.get("/opcuaIIoT/list/InstanceTypeIds",s.auth.needsPermission("opcuaIIoT.list.instancetypeids"),function(e,n){var o=b.core.nodeOPCUA.ObjectTypeIds,t=b.core.nodeOPCUA.VariableTypeIds,i=f.toArray(f.invert(o)),r=f.toArray(f.invert(t)),s=[],a=void 0,l=!0,c=!1,u=void 0;try{for(var d,p=i[Symbol.iterator]();!(l=(d=p.next()).done);l=!0)a=d.value,s.push({nodeId:"i="+o[a],label:a})}catch(e){c=!0,u=e}finally{try{!l&&p.return&&p.return()}finally{if(c)throw u}}var g=!0,C=!1,y=void 0;try{for(var S,h=r[Symbol.iterator]();!(g=(S=h.next()).done);g=!0)a=S.value,s.push({nodeId:"i="+o[a],label:a})}catch(e){C=!0,y=e}finally{try{!g&&h.return&&h.return()}finally{if(C)throw y}}n.json(s)}),s.httpAdmin.get("/opcuaIIoT/list/VariableTypeIds",s.auth.needsPermission("opcuaIIoT.list.variabletypeids"),function(e,n){var o=b.core.nodeOPCUA.VariableTypeIds,t=f.toArray(f.invert(o)),i=[],r=void 0,s=!0,a=!1,l=void 0;try{for(var c,u=t[Symbol.iterator]();!(s=(c=u.next()).done);s=!0)r=c.value,i.push({nodeId:"i="+o[r],label:r})}catch(e){a=!0,l=e}finally{try{!s&&u.return&&u.return()}finally{if(a)throw l}}n.json(i)}),s.httpAdmin.get("/opcuaIIoT/list/ReferenceTypeIds",s.auth.needsPermission("opcuaIIoT.list.referencetypeids"),function(e,n){var o=b.core.nodeOPCUA.ReferenceTypeIds,t=f.toArray(f.invert(o)),i=[],r=void 0,s=!0,a=!1,l=void 0;try{for(var c,u=t[Symbol.iterator]();!(s=(c=u.next()).done);s=!0)r=c.value,i.push({nodeId:"i="+o[r],label:r})}catch(e){a=!0,l=e}finally{try{!s&&u.return&&u.return()}finally{if(a)throw l}}n.json(i)})};
//# sourceMappingURL=maps/opcua-iiot-connector.js.map
