"use strict";module.exports=function(e){require("source-map-support").install();var t=require("./core/opcua-iiot-core-response");e.nodes.registerType("OPCUA-IIoT-Response",function(a){e.nodes.createNode(this,a),this.name=a.name,this.showStatusActivities=a.showStatusActivities,this.showErrors=a.showErrors;var s=this;s.status({fill:"blue",shape:"ring",text:"..."}),s.on("input",function(e){try{if(e.nodetype)switch(e.nodetype){case"read":s.analyzeReadResults(e);break;case"write":s.analyzeWriteResults(e);break;case"listen":s.analyzeListenerResults(e);break;case"method":s.analyzeMethodResults(e);break;default:e&&e.payload&&s.handlePayloadStatusCode(e)}}catch(a){t.internalDebugLog(a),s.showErrors&&s.error(a,e)}s.send(e)}),s.analyzeReadResults=function(a){switch(a.readtype){case"AllAttributes":case"VariableValue":s.handlePayloadStatusCode(a);break;case"Meta":s.setNodeStatus([0,0,0],"None");break;default:s.handlePayloadStatusCode(a)}},s.analyzeListenerResults=function(a){switch(a.injectType){case"subscribe":s.analyzeSubscribeResultStatus(a);break;case"event":s.analyzeEventResultStatus(a)}},s.analyzeMethodResults=function(a){switch(a.methodType){case"basic":case"complex":s.handlePayloadStatusCode(a)}},s.setNodeStatus=function(a,e){var t="green";0<a[2]&&(t="yellow"),0<a[1]&&(t="red"),s.status({fill:t,shape:"dot",text:e})},s.analyzeWriteResults=function(a){var e=s.handlePayloadArrayOfStatusCodes(a);a.entryStatus=e,s.setNodeStatus(e,"Good:"+e[0]+" Bad:"+e[1]+" Other:"+e[2])},s.analyzeSubscribeResultStatus=function(a){s.handlePayloadStatusCode(a)},s.analyzeEventResultStatus=function(a){s.handlePayloadStatusCode(a)},s.handlePayloadStatusCode=function(a){var e=[0,0,0];e=a.payload.length||a.payload.results||a.payload.statusCodes?s.handlePayloadArrayOfObjects(a):s.handlePayloadObject(a),a.entryStatus=e,s.setNodeStatus(e,"Good:"+e[0]+" Bad:"+e[1]+" Other:"+e[2])},s.handlePayloadArrayOfObjects=function(a){var e=null,t=[0,0,0],s=[];a.payload.results?s=a.payload.results:a.payload.statusCodes?s=a.payload.statusCodes:a.payload.length&&(s=a.payload);var o=!0,l=!1,d=void 0;try{for(var n,r=s[Symbol.iterator]();!(o=(n=r.next()).done);o=!0)if((e=n.value).statusCode&&e.statusCode.name)switch(e.statusCode.name){case"Good":t[0]+=1;break;case"Bad":t[1]+=1;break;default:e.statusCode.name.includes("Good")?t[0]+=1:e.statusCode.name.includes("Bad")?t[1]+=1:t[2]+=1}else t[2]+=1}catch(a){l=!0,d=a}finally{try{!o&&r.return&&r.return()}finally{if(l)throw d}}return t},s.handlePayloadObject=function(a){var e=[0,0,0];if((a.payload.results||a.payload.statusCodes)&&(e=s.handlePayloadArrayOfObjects(a)),a.payload&&a.payload.statusCode)if(a.payload.statusCode.name)switch(a.payload.statusCode.name){case"Good":e[0]+=1;break;case"Bad":e[1]+=1;break;default:a.payload.statusCode.name.includes("Good")?e[0]+=1:a.payload.statusCode.name.includes("Bad")?e[1]+=1:e[2]+=1}else e[2]+=1;else e[2]+=1;return e},s.handlePayloadArrayOfStatusCodes=function(a){var e=null,t=[0,0,0];if(a.payload.statusCodes){var s=!0,o=!1,l=void 0;try{for(var d,n=a.payload.statusCodes[Symbol.iterator]();!(s=(d=n.next()).done);s=!0)if((e=d.value)&&e.name)switch(e.name){case"Good":t[0]+=1;break;case"Bad":t[1]+=1;break;default:e.name.includes("Good")?t[0]+=1:e.name.includes("Bad")?t[1]+=1:t[2]+=1}else t[2]+=1}catch(a){o=!0,l=a}finally{try{!s&&n.return&&n.return()}finally{if(o)throw l}}}else t[2]+=1;return t}})};
//# sourceMappingURL=maps/opcua-iiot-response.js.map
